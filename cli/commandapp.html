<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link href="/assets/styles.css" rel="stylesheet" />
        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet" />

        <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">

        <title>Spectre.Console - CommandApp</title>
        <meta name="description" content="**CommandApp** is the entry point for a *Spectre.Console.Cli* command line application. It is used to configure the settings and commands used for execution of the application." />

            <meta name="twitter:card" content="summary_large_image" />
            <meta name="og:title" content="Spectre.Console - CommandApp" />
            <meta name="og:description" content="**CommandApp** is the entry point for a *Spectre.Console.Cli* command line application. It is used to configure the settings and commands used for execution of the application." />
            <meta name="og:image" content="https://spectreconsole.net/cli/commandapp-social.png" />

    </head>
    <body class="antialiased text-gray-600 min-h-full flex flex-col  bg-gray-50">
        <header class="flex-none text-sm font-medium bg-gradient-to-b from-gray-200 to-gray-100 ring-1 ring-gray-900 ring-opacity-5 shadow py-2 md:py-4">
            <nav class="flex flex-row container mx-auto items-center">
                <a class="flex flex-row  items-center" href="/">
                    <img id="logo" class="w-auto h-10 md:h-12" height="48" width="48" src="/assets/logo.svg" alt="Spectre.Console">
                    <span class="text-lg md:text-2xl font-light ml-2 lg:ml-4 font-mono tracking-tighter">Spectre.Console</span>
                </a>
                <div class="ml-auto">
                    <ul class="flex flex-row">
                        <li>
                            <a class="flex flex-row items-center text-red-700" href="https://github.com/sponsors/patriksvensson">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <title>Sponsor</title>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                                </svg>
                                <span class="hidden sm:block">Sponsor</span>
                            </a>
                        </li>
                        <li class="ml-4">
                            <a class="flex flex-row items-center text-gray-600" href="https://github.com/spectreconsole/spectre.console">
                                <svg role="img" class="h-6 w-6 mr-2"  stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <title>GitHub icon</title>
                                    <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
                                <span class="hidden sm:block">GitHub</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <main class="container mx-auto pt-4 md:pt-8 w-full">
            <div class="flex flex-col-reverse lg:flex-row">
                <nav class="flex-none font-light text-sm xl:text-base sm:mr-16 mt-8 pt-6 lg:mt-0 lg:pt-0 border-t border-gray-300 lg:border-t-0">
                    <div class="text-xl">
<a href="/">Welcome</a>                    </div>
                        <div class="text-blue-700 mt-4">
<a href="/sponsors">Sponsors</a>                        </div>
                        <div class="text-blue-700 mt-4">
<a href="/quick-start">Quick Start</a>                        </div>
                        <div class="text-blue-700 mt-4">
<a href="/blog">Recent Blog Posts</a>                        </div>
                            <div class="ml-2 flex flex-row flex-wrap lg:flex-col border-separate">
                                    <div class="mt-2 mr-4">
                                        <a href="/blog/release-notes">Release Notes</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/blog/news">News</a>
                                    </div>
                            </div>
                        <div class="text-blue-700 mt-4">
<a href="/markup">Markup</a>                        </div>
                        <div class="text-blue-700 mt-4">
<a href="/exceptions">Exceptions</a>                        </div>
                        <div class="text-blue-700 mt-4">
<a href="/live">Live</a>                        </div>
                            <div class="ml-2 flex flex-row flex-wrap lg:flex-col border-separate">
                                    <div class="mt-2 mr-4">
                                        <a href="/live/live-display">Live Display</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/live/progress">Progress</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/live/status">Status</a>
                                    </div>
                            </div>
                        <div class="text-blue-700 mt-4">
<a href="/prompts">Prompts</a>                        </div>
                            <div class="ml-2 flex flex-row flex-wrap lg:flex-col border-separate">
                                    <div class="mt-2 mr-4">
                                        <a href="/prompts/text">Text prompt</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/prompts/selection">Selection</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/prompts/multiselection">Multi Selection</a>
                                    </div>
                            </div>
                        <div class="text-blue-700 mt-4">
<a href="/widgets">Widgets</a>                        </div>
                            <div class="ml-2 flex flex-row flex-wrap lg:flex-col border-separate">
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/table">Table</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/tree">Tree</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/barchart">Bar Chart</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/rule">Rule</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/calendar">Calendar</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/figlet">Figlet</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/canvas">Canvas</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/widgets/canvas-image">Canvas Image</a>
                                    </div>
                            </div>
                        <div class="text-blue-700 mt-4">
<a href="/cli">Spectre.Console.Cli</a>                        </div>
                            <div class="ml-2 flex flex-row flex-wrap lg:flex-col border-separate">
                                    <div class="mt-2 mr-4">
                                        <a href="/cli/getting-started">Getting Started</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/cli/introduction">Introduction</a>
                                    </div>
                                    <div class="mt-2 mr-4 font-bold">
                                        <a href="/cli/commandapp">CommandApp</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/cli/settings">Specifying Settings</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/cli/commands">Creating Commands</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/cli/composing">Composing Commands</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/cli/migration">Migrate from Spectre.Cli</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/cli/exceptions">Exceptions</a>
                                    </div>
                            </div>
                        <div class="text-blue-700 mt-4">
<a href="/appendix">Appendix</a>                        </div>
                            <div class="ml-2 flex flex-row flex-wrap lg:flex-col border-separate">
                                    <div class="mt-2 mr-4">
                                        <a href="/appendix/colors">Colors</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/appendix/styles">Styles</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/appendix/borders">Borders</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/appendix/emojis">Emojis</a>
                                    </div>
                                    <div class="mt-2 mr-4">
                                        <a href="/appendix/spinners">Spinners</a>
                                    </div>
                            </div>
                </nav>
                <article class="flex-1 min-w-0">
                    <header class="text-gray-800 mb-4">
                        <h1 class="text-4xl font-extrabold">CommandApp</h1>
                        
                    </header>
                    <div class="prose max-w-none prose-sm lg:prose lg:max-w-none 2xl:prose-xl 2xl:max-w-none text-gray-700 font-light">
                        <p><code>CommandApp</code> is the entry point for a <code>Spectre.Console.Cli</code> command line application. It is used to configure the settings and commands used for execution of the application. Most <code>Spectre.Console.Cli</code> applications will need to specify a custom configuration using the <code>Configure</code> method.</p>
<p>For example, the following configuration might be used to change the default behavior indicate that for <code>DEBUG</code> configuration's full exception stack traces should be outputted to the screen, and any examples defined for our commands will also be validated.</p>
<pre><code class="language-csharp">var app = new CommandApp&lt;FileSizeCommand&gt;();
app.Configure(config =&gt;
{
#if DEBUG
    config.PropagateExceptions();
    config.ValidateExamples();
#endif
});
</code></pre>
<h2 id="multiple-commands">Multiple Commands</h2>
<p>In the previous example we have a single command that is configured. For complex command line applications, it is common for them to have multiple commands (or verbs) defined. Examples of applications like this are <code>git</code>, <code>dotnet</code> and <code>gh</code>. For example, git would have a <code>commit</code> command and along with other commits like <code>add</code> or <code>rebase</code>. Each with their own settings and validation. With <code>Spectre.Console.Cli</code> we use the <code>Configure</code> method to add these commands.</p>
<p>For example, to add three different commands to the application:</p>
<pre><code class="language-csharp">var app = new CommandApp();
app.Configure(config =&gt;
{
    config.AddCommand&lt;AddCommand&gt;(&quot;add&quot;);
    config.AddCommand&lt;CommitCommand&gt;(&quot;commit&quot;);
    config.AddCommand&lt;RebaseCommand&gt;(&quot;rebase&quot;);
});
</code></pre>
<p>This configuration would allow users to run <code>app.exe add</code>, <code>app.exe commit</code>, or <code>app.exe rebase</code> and have the settings routed to the appropriate command.</p>
<p>For more complex command hierarchical configurations, they can also be composed via inheritance and branching. See <a href="composing">Composing Commands</a>.</p>
<h2 id="customizing-command-configurations">Customizing Command Configurations</h2>
<p>The <code>Configure</code> method is also used to change how help for the commands is generated. This configuration will give our command an additional alias of <code>file-size</code> and a description to be used when displaying the help. Additional, an example is specified that will be parsed and displayed for users asking for help. Multiple examples can be provided. Commands can also be marked as hidden. With this option they are still executable, but will not be displayed in help screens.</p>
<pre><code class="language-csharp">var app = new CommandApp();
app.Configure(config =&gt;
{
    config.AddCommand&lt;FileSizeCommand&gt;(&quot;size&quot;)
        .IsHidden()
        .WithAlias(&quot;file-size&quot;)
        .WithDescription(&quot;Gets the file size for a directory.&quot;)
        .WithExample(new[] {&quot;size&quot;, &quot;c:\\windows&quot;, &quot;--pattern&quot;, &quot;*.dll&quot;});
});
</code></pre>
<h2 id="dependency-injection">Dependency Injection</h2>
<p><code>CommandApp</code> takes care of instantiating commands upon execution. If given a custom type registrar, it will use that to resolve services defined in the command constructor.</p>
<pre><code class="language-csharp">var registrations = new ServiceCollection();
registrations.AddSingleton&lt;IGreeter, HelloWorldGreeter&gt;();

// Create a type registrar and register any dependencies.
// A type registrar is an adapter for a DI framework.
var registrar = new TypeRegistrar(registrations);

// Create a new command app with the registrar
// and run it with the provided arguments.
var app = new CommandApp&lt;DefaultCommand&gt;(registrar);
return app.Run(args);
</code></pre>
<p><code>TypeRegistrar</code> is a custom class that must be created by the user. This <a href="https://github.com/spectreconsole/spectre.console/tree/main/examples/Cli/Injection">example using <code>Microsoft.Extensions.DependencyInjection</code> as the container</a> provides an example <code>TypeRegistrar</code> and <code>TypeResolver</code> that can be added to your application with small adjustments for your DI container.</p>
<p>Hint: If you do write your own implementation of <code>TypeRegistrar</code> and <code>TypeResolver</code> and you have some form of unit tests in place for your project,
there is a utility <code>TypeRegistrarBaseTests</code> available that can be used to ensure your implementations adhere to the required implementation. Simply call <code>TypeRegistrarBaseTests.RunAllTests()</code> and expect no <code>TypeRegistrarBaseTests.TestFailedException</code> to be thrown.</p>
<h2 id="interception">Interception</h2>
<p><code>CommandApp</code> also provides a <code>SetInterceptor</code> configuration. An interceptor is run before all commands are executed. This is typically used for configuring logging or other infrastructure concerns.</p>
<p>All interceptors must implement <code>ICommandInterceptor</code>. Upon execution of a command, an instance of your interceptor will be called with the parsed settings. This provides an opportunity for configuring any infrastructure or modifying the settings.</p>
<p>For an example of using the interceptor to configure logging, see the <a href="https://github.com/spectreconsole/spectre.console/tree/main/examples/Cli/Logging">Serilog demo</a>.</p>

                    </div>
                </article>
            </div>
        </main>

        <footer class="py-4 md:py-8 mt-8 bg-gray-100 text-sm border-t border-gray-200">
            <div class="container">
                <div class="flex flex-row">
                    <span>© 2022 Patrik Svensson, Phil Scott</span>
                    <span class="ml-auto">1.0.0</span>
                </div>
            </div>
        </footer>


    <script>
        // adapted from https://www.w3schools.com/howto/howto_js_filter_table.asp
        function search(input, searchTarget, columnIndex) {
            // Declare variables
            var filter, table, tr, td, i, txtValue;
            filter = input.value.toUpperCase();
            table = document.getElementById(searchTarget);
            tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those who don't match the search query
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[columnIndex];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }
    </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js" integrity="sha512-YBk7HhgDZvBxmtOfUdvX0z8IH2d10Hp3aEygaMNhtF8fSOvBZ16D/1bXZTJV6ndk/L/DlXxYStP8jrF77v2MIg==" crossorigin="anonymous"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-zc7WDnCM3aom2EziyDIRAtQg1mVXLdILE09Bo+aE1xk0AM2c2cVLfSW9NrxE5tKTX44WBY0Z2HClZ05ur9vB6A==" crossorigin="anonymous"></script>
        <script src="/assets/asciinema-player.js"></script>
        <script>
            document.querySelectorAll('asciinema-player').forEach(cast => {
                AsciinemaPlayer.create(cast.attributes['src'].value, cast, {autoplay: true, fit: 'none', fontSize: 'inherit'});
            });
        </script>
    </body>
</html>